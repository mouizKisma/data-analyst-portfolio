<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Cyclistic Member vs Casual Riders Dashboard</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <style>
        /* ====== Basic Reset & Theme (keeps same styling/colors/animations) ====== */
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg,#667eea 0%,#764ba2 100%);
            color: #333;
            min-height: 100vh;
        }
        .dashboard-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }
        .header { text-align:center; color: white; margin-bottom: 20px; animation: slideDown .8s ease-out; }
        .header h1 { font-size: 2.4rem; margin-bottom: 8px; text-shadow: 2px 2px 4px rgba(0,0,0,.3); }
        .header p { font-size: 1.05rem; opacity: .95; }

        /* KPI grid */
        .kpi-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        .kpi-card {
            background: rgba(255,255,255,.95);
            backdrop-filter: blur(10px);
            padding: 20px;
            border-radius: 20px;
            box-shadow: 0 8px 32px rgba(0,0,0,.1);
            border: 1px solid rgba(255,255,255,.2);
            transition: transform .28s ease, box-shadow .28s ease;
            text-align: center;
        }
        .kpi-card:hover { transform: translateY(-4px); box-shadow: 0 14px 40px rgba(0,0,0,.15); }
        .kpi-card h3 { font-size: .95rem; color:#555; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 12px; }
        .kpi-values { display:flex; justify-content:space-around; align-items:center; gap:12px; }
        .kpi-value { text-align:center; }
        .kpi-number { font-size:2.2rem; font-weight:700; margin-bottom:6px; }
        .kpi-label { font-size:.9rem; color:#666; font-weight:600; }

        .member-color { color: #1E88E5; }
        .casual-color { color: #FF7043; }

        /* Charts layout - keep prominent charts large */
        .chart-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            grid-template-rows: auto auto;
            grid-template-areas:
                "percent hourly"
                "monthly monthly";
            gap: 25px;
            margin-bottom: 30px;
        }
        .chart-card {
            background: rgba(255,255,255,.95);
            backdrop-filter: blur(10px);
            padding: 20px;
            border-radius: 20px;
            box-shadow: 0 8px 32px rgba(0,0,0,.1);
            border: 1px solid rgba(255,255,255,.2);
            display:flex;
            flex-direction:column;
            transition: transform .28s ease, box-shadow .28s ease;
        }
        .chart-card:hover { transform: translateY(-3px); box-shadow: 0 12px 35px rgba(0,0,0,.15); }
        .chart-card h3 { color:#555; font-size:1.2rem; margin-bottom: 14px; text-align:center; }
        .chart-container { position:relative; height:520px; }
        .chart-container.small { height:380px; }

        .chart-percent { grid-area: percent; }
        .chart-hourly { grid-area: hourly; }
        .chart-monthly { grid-area: monthly; }

        @keyframes slideDown { from { opacity:0; transform: translateY(-50px) } to { opacity:1; transform: translateY(0) } }
        @media (max-width:1100px) { .chart-container { height:480px } }
        @media (max-width:768px) {
            .chart-grid { grid-template-columns: 1fr; grid-template-areas: "percent" "hourly" "monthly"; }
            .chart-container { height:420px; }
            .kpi-values { flex-direction:column; gap:10px; }
            .header h1 { font-size:2.2rem; }
        }
        /* Small accessibility helper for screen readers only */
        .sr-only { position:absolute; width:1px; height:1px; padding:0; margin:-1px; overflow:hidden; clip:rect(0,0,0,0); white-space:nowrap; border:0; }
    </style>
</head>
<body>
    <main class="dashboard-container" role="main" aria-labelledby="dashboardTitle">
        <header class="header" role="banner">
            <h1 id="dashboardTitle">Cyclistic Analytics Dashboard</h1>
            <p>Member vs Casual Rider Behavior Analysis — Real Data</p>
        </header>

        <!-- KPI Cards: EXACTLY 3 (Average Ride Duration, Peak Usage Hour, Peak Usage Month) -->
        <section class="kpi-grid" aria-label="Key performance indicators">
            <div class="kpi-card" role="group" aria-labelledby="avg-duration">
                <h3 id="avg-duration">Average Ride Duration</h3>
                <div class="kpi-values" aria-hidden="false">
                    <div class="kpi-value">
                        <div class="kpi-number member-color">11.6</div>
                        <div class="kpi-label">Minutes (Members)</div>
                    </div>
                    <div class="kpi-value">
                        <div class="kpi-number casual-color">18.6</div>
                        <div class="kpi-label">Minutes (Casual)</div>
                    </div>
                </div>
            </div>

            <!-- NEW: Peak Usage Hour (replaces Total Yearly Ride Time KPI) -->
            <div class="kpi-card" role="group" aria-labelledby="peak-hour">
                <h3 id="peak-hour">Peak Usage Hour</h3>
                <div class="kpi-values" aria-hidden="false" style="gap:8px;">
                    <div class="kpi-value">
                        <div class="kpi-number member-color">17:00</div>
                        <div class="kpi-label">Members</div>
                    </div>
                    <div class="kpi-value">
                        <div class="kpi-number casual-color">17:00</div>
                        <div class="kpi-label">Casual</div>
                    </div>
                </div>
            </div>

            <div class="kpi-card" role="group" aria-labelledby="peak-month">
                <h3 id="peak-month">Peak Usage Month</h3>
                <div class="kpi-values">
                    <div class="kpi-value">
                        <div class="kpi-number member-color">Sep</div>
                        <div class="kpi-label">Members</div>
                    </div>
                    <div class="kpi-value">
                        <div class="kpi-number casual-color">Jul</div>
                        <div class="kpi-label">Casual</div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Charts: prominent two (Percentage & Hourly) and monthly below -->
        <section class="chart-grid" aria-label="Charts section">

            <!-- Percentage of Rides by Membership Type (NEW, replaces Total Yearly Ride Time chart) -->
            <div class="chart-card chart-percent" aria-labelledby="percent-title">
                <h3 id="percent-title">Percentage of Rides by Membership Type</h3>
                <div class="chart-container" role="img" aria-label="Doughnut chart showing percentage of rides by membership type">
                    <canvas id="percentChart" aria-label="Percentage of rides by membership type"></canvas>
                </div>
            </div>

            <!-- Hourly Usage Patterns (prominent) -->
            <div class="chart-card chart-hourly" aria-labelledby="hourly-title">
                <h3 id="hourly-title">Hourly Usage Patterns (24-Hour)</h3>
                <div class="chart-container" role="img" aria-label="Hourly usage patterns line chart">
                    <canvas id="hourlyChart" aria-label="Hourly usage chart"></canvas>
                </div>
            </div>

            <!-- Monthly Usage Patterns (full width below) -->
            <div class="chart-card chart-monthly" aria-labelledby="monthly-title">
                <h3 id="monthly-title">Monthly Usage Patterns (2024-2025)</h3>
                <div class="chart-container small" role="img" aria-label="Monthly usage patterns chart">
                    <canvas id="monthlyChart" aria-label="Monthly usage chart"></canvas>
                </div>
            </div>
        </section>
        <p class="sr-only" aria-hidden="false">Important: Peak hour for both Members and Casual riders is 17:00 (5 PM). Members account for 65.1% of rides (≈2.4M) and Casual riders 34.9% (≈1.3M) out of ~3.7M total rides.</p>
    </main>

    <script>
        // Chart.js defaults
        Chart.defaults.font.family = "'Segoe UI', Tahoma, Geneva, Verdana, sans-serif";
        Chart.defaults.plugins.legend.position = 'bottom';

        const memberColor = '#1E88E5';
        const casualColor = '#FF7043';

        // ---------- Monthly Chart (unchanged) ----------
        function createMonthlyChart() {
            const ctx = document.getElementById('monthlyChart').getContext('2d');
            new Chart(ctx, {
                type: 'line',
                data: {
                    labels: ['Jun 2024','Jul 2024','Aug 2024','Sep 2024','Oct 2024','Nov 2024','Dec 2024','Jan 2025','Feb 2025','Mar 2025','Apr 2025','May 2025','Jun 2025'],
                    datasets: [{
                        label: 'Members',
                        data: [36,298289,301184,309642,280424,171577,99145,81475,87013,142817,175459,207386,244095],
                        borderColor: memberColor,
                        backgroundColor: memberColor + '20',
                        fill: true,
                        tension: 0.4,
                        pointRadius: 6,
                        pointHoverRadius: 8
                    },{
                        label: 'Casual',
                        data: [64,206432,204416,195476,145556,64021,26078,15995,18428,55481,69141,112548,172216],
                        borderColor: casualColor,
                        backgroundColor: casualColor + '20',
                        fill: true,
                        tension: 0.4,
                        pointRadius: 6,
                        pointHoverRadius: 8
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { labels: { usePointStyle: true, padding: 20 } }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            grid: { color: '#e0e0e0' },
                            title: { display: true, text: 'Number of Rides' },
                            ticks: {
                                callback: function(value){ return (value/1000).toFixed(0) + 'K'; }
                            }
                        },
                        x: { grid: { color: '#e0e0e0' },
                    title: { display: true, text: 'Month' } }
                    }
                }
            });
        }

        // ---------- Hourly Chart (unchanged, prominent) ----------
        function createHourlyChart() {
            const ctx = document.getElementById('hourlyChart').getContext('2d');
            new Chart(ctx, {
                type: 'line',
                data: {
                    labels: ['0','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23'],
                    datasets: [{
                        label: 'Members',
                        data: [17055,12439,12027,15618,26970,57239,93867,142916,124459,94156,95637,104127,112830,118598,127421,144508,165094,188354,136951,98256,75504,59183,45026,31928],
                        borderColor: memberColor,
                        backgroundColor: memberColor + '20',
                        fill: true,
                        tension: 0.35,
                        pointRadius: 4,
                        pointHoverRadius: 6
                    },{
                        label: 'Casual',
                        data: [8363,5798,5239,6139,8738,13892,19135,27615,38736,53436,69837,81565,88079,94567,101564,105062,109652,111094,92847,73347,52551,43635,38032,27082],
                        borderColor: casualColor,
                        backgroundColor: casualColor + '20',
                        fill: true,
                        tension: 0.35,
                        pointRadius: 4,
                        pointHoverRadius: 6
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { labels: { usePointStyle: true, padding: 20 } }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            grid: { color: '#e0e0e0' },
                            title: { display: true, text: 'Number of Rides' },
                            ticks: { callback: v => (v/1000).toFixed(0) + 'K' }
                        },
                        x: {
                            grid: { color: '#e0e0e0' },
                            title: { display: true, text: 'Hour of Day' }
                        }
                    }
                }
            });
        }

        // ---------- Percentage Doughnut Chart (NEW) ----------
        // Values given: Members 2.4M, Casual 1.3M (total ~3.7M). Percentages 65.1% / 34.9%.
        function createPercentChart() {
            const ctx = document.getElementById('percentChart').getContext('2d');
            const members = 2400000;
            const casual = 1300000;
            const total = members + casual;
            const membersPct = (members / total * 100);
            const casualPct = (casual / total * 100);

            const chart = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['Members','Casual'],
                    datasets: [{
                        data: [members, casual],
                        backgroundColor: [memberColor, casualColor],
                        hoverOffset: 10,
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    cutout: '60%',
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: { usePointStyle: true, padding: 20 }
                        },
                        tooltip: {
                            callbacks: {
                                label: function(ctx) {
                                    const value = ctx.raw;
                                    const pct = (value / total * 100).toFixed(1) + '%';
                                    const formatted = (value >= 1000000) ? (value/1000000).toFixed(1) + 'M' : value.toLocaleString();
                                    return ctx.label + ': ' + formatted + ' (' + pct + ')';
                                }
                            }
                        }
                    }
                },
                plugins: [{
                    // Draw custom labels on each arc (no center text)
                    id: 'percentLabelsAndCenter',
                    afterDraw: function(chartInstance, args, options) {
                        const {ctx, data} = chartInstance;
                        ctx.save();
                        const meta = chartInstance.getDatasetMeta(0);
                        const total = data.datasets[0].data.reduce((a, b) => a + b, 0);

                        // Draw label for each arc
                        meta.data.forEach((arc, i) => {
                            const value = data.datasets[0].data[i];
                            const pct = (value / total * 100).toFixed(1) + '%';
                            // Compute centroid of arc
                            const centerAngle = (arc.startAngle + arc.endAngle) / 2;
                            const radius = (arc.outerRadius + arc.innerRadius) / 2;
                            const x = arc.x + Math.cos(centerAngle) * radius;
                            const y = arc.y + Math.sin(centerAngle) * radius;

                            ctx.font = '600 20px "Segoe UI", Tahoma, Geneva, Verdana, sans-serif';
                            ctx.textAlign = 'center';
                            ctx.textBaseline = 'middle';
                            ctx.fillStyle = '#fff';
                            ctx.fillText(pct, x, y);
                        });

                        ctx.restore();
                    }
                }]

            });

            return chart;
        }

        // Initialize charts (ensures prominence visually by order and sizing)
        window.addEventListener('load', function() {
            try {
                // Create prominent charts first for immediate rendering and emphasis
                createPercentChart();
                createHourlyChart();
                createMonthlyChart();
            } catch (err) {
                console.error('Chart initialization error:', err);
            }
        });
    </script>
</body>
</html>
